<!DOCTYPE html>
<html
    class="has-navbar-fixed-top text-gray-800 antialiased bg-white"
    lang="{{ $.Site.Language.Lang }}"
>
    <head>
        {{ if .IsHome -}}
            <title>{{ .Site.Title }}</title>
            {{- else -}}
            <title>{{ .Title }} – {{ .Site.Title }}</title>
        {{- end }}
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        {{ if .Params.author -}}
            <meta name="author" content="{{ .Params.author }}" />
        {{- end }}
        {{ if .Params.date -}}
            <meta name="date" content="{{ .Date.Format `Jan 2, 2006` }}" />
        {{- end }}
        {{ if eq .Section "policies" -}}
            <meta name="robots" content="noindex" />
        {{- end }}
        <meta name="referrer" content="no-referrer-when-downgrade" />
        <link rel="canonical" href="{{ .Permalink }}" />
        {{- if .IsTranslated }}
            {{- range .Translations }}
                <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}" />
            {{- end }}
        {{- end }}
        <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}" />
        <!-- Primary Meta Tags -->
        <meta name="title" content="{{ .Title }}" />
        <!-- Description tags -->
        <meta
            name="description"
            content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Site.Params.description }}{{ end }}"
        />
        <meta
            itemprop="description"
            content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Site.Params.description }}{{ end }}"
        />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="{{ .Permalink }}" />
        <meta property="og:title" content="{{ .Title }}" />
        <meta
            property="og:description"
            content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Site.Params.description }}{{ end }}"
        />
        <meta
            property="og:image"
            content="{{ if .Params.illustration }}{{ .Permalink }}{{ .Params.illustration }}{{ else }}{{ .Site.Params.Image | absURL }}{{ end }}"
        />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="{{ .Permalink }}" />
        <meta property="twitter:title" content="{{ .Title }}" />
        <meta
            property="twitter:description"
            content="{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Site.Params.description }}{{ end }}"
        />
        <meta
            property="twitter:image"
            content="{{ if .Params.illustration }}{{ .Permalink }}{{ .Params.illustration }}{{ else }}{{ .Site.Params.Image | absURL }}{{ end }}"
        />

        {{ if .Site.IsServer }}
            {{- $style := resources.Get "css/styles.css" | postCSS (dict "config" "./postcss.config.js") | fingerprint }}
            <link rel="stylesheet" href="{{ $style.RelPermalink }}" data />
            {{ else }}
            {{- $style := resources.Get "css/styles.css" | postCSS (dict "config" "./postcss.config.js")  | minify | fingerprint -}}

            <link
                rel="stylesheet"
                href="{{ $style.RelPermalink }}"
                integrity="{{ $style.Data.Integrity }}"
            />
        {{ end -}}
        {{- $alpine := resources.Get "js/alpine.js" | minify | fingerprint }}
        {{- $lazysizes := resources.Get "js/lazysizes.js" | minify | fingerprint }}
        <script
            src="{{ $alpine.RelPermalink }}"
            defer
        ></script>
        <script src="{{ $lazysizes.RelPermalink }}" defer async=""></script>

        {{ if not .Site.IsServer }}
            <!-- OR WITH ENV VAR if eq (getenv "HUGO_ENV") "production"  -->
            <!--ONLY PRODUCTION-->
            {{ partial "analytics.html" . }}
        {{ end }}
    </head>

    <body x-data="{ mobileMenuOpen: false, iealert: true }">
        <div
            id="IEalert"
            style="display: none;"
            class=" mt-16 py-15 p-10 bg-yellow-300 text-cool-gray-900"
        >
            <div class="max-w-7xl mx-auto">
                <div class="text-lg font-black">Votre navigateur n'est plus supporté</div>
                <a
                    href="microsoft-edge:https://www.pilot.pm"
                    class="bg-yellow-100 hover:bg-gray-200 active:bg-gray-300 focus:shadow-outline-gray border border-yellow-200 shadow text-yellow-900 text-center font-medium p-2 rounded my-2 inline-flex items-center"
                >
                    Vous êtes sur Windows 10 ? Cliquez ici ( ou Ctrl+Shift+E ) pour ouvrir ce site
                    avec Edge
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        class="h-4 w-4 mx-2"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                        />
                    </svg>
                </a>
                <p>
                    Sinon vous pouvez télécharger un navigateur moderne (
                    <a class="underline" href="https://www.microsoft.com/fr-fr/edge">Edge</a>
                    ,
                    <a class="underline" href="https://www.google.com/intl/fr_fr/chrome/">Chrome</a>
                    ,
                    <a class="underline" href="https://www.mozilla.org/fr/firefox/new/">Firefox</a>
                    )
                </p>
            </div>
        </div>

        <div class="flex flex-col justify-between h-screen w-full">
            <header
                id="mainnav"
                class="transform top-0 left-0 fixed top-0 w-full shadow bg-white z-40 px-5 transition-all ease-in duration-300 "
            >
                {{ partial "header" . }}
            </header>
            <main class="flex-1 mt-28 px-5">
                {{ block "main" . }}{{ end }}
            </main>
            {{ if ne .Type "documentation" }}
                <footer>
                    {{ partial "footer.html" . }}
                </footer>
            {{ end }}
        </div>
        {{ if not .Site.IsServer }}
            <!-- OR WITH ENV VAR if eq (getenv "HUGO_ENV") "production"  -->
            <!--ONLY PRODUCTION-->
            {{ partial "chat.html" . }}
        {{ end }}
        <script>
            if (
                navigator.userAgent.indexOf("MSIE") !== -1 ||
                navigator.appVersion.indexOf("Trident/") > -1
            ) {
                console.log("IE detected")
                var element = document.getElementById("IEalert")
                element.style.display = "block"
            }
        </script>
        {{ block "script" . }}{{ end }}
        <script>
            ;(function () {
                var doc = document.documentElement
                var w = window

                var prevScroll = w.scrollY || doc.scrollTop
                var curScroll
                var direction = 0
                var prevDirection = 0
                var buffer = 0

                var header = document.getElementById("mainnav")

                var checkScroll = function () {
                    /*
                     ** Find the direction of scroll
                     ** 0 - initial, 1 - up, 2 - down
                     */

                    curScroll = w.scrollY || doc.scrollTop
                    if (curScroll > prevScroll) {
                        //scrolled up
                        direction = 2
                    } else if (curScroll < prevScroll) {
                        //scrolled down
                        direction = 1
                    }

                    if (direction !== prevDirection) {
                        toggleHeader(direction, curScroll)
                    }

                    prevScroll = curScroll
                }
                var checkDelta = function () {
                    var position = w.scrollY || doc.scrollTop
                }

                var toggleHeader = function (direction, curScroll) {
                    if (direction === 2) {
                        //replace 52 with the height of your header in px

                        header.classList.add("-translate-y-full")
                        prevDirection = direction
                    } else if (direction === 1) {
                        header.classList.remove("-translate-y-full")
                        prevDirection = direction
                    }
                }

                window.addEventListener("scroll", checkScroll)
                window.addEventListener("scroll", checkDelta)
            })()
        </script>
    </body>
</html>
